{
    "collab_server" : "",
    "contents" : "library(flowCore)\n\n# ------------------------------------------------------------------------------\n# sim from Bendall\n# ------------------------------------------------------------------------------\n\nfcs_path <- '/users/hlc/dropbox/thesis/data/Bendall/Bendall et al Cell Sample C_IL7.fcs'\nff <- read.FCS(fcs_path)\n\n# channels used by Wanderlust\nwl_chs <- c(\"CD45(In115)Di\", \"CD19(Nd142)Di\", \"IgD(Nd145)Di\", \"CD79b(Nd146)Di\", \"CD20(Sm147)Di\", \"CD34(Nd148)Di\", \"CD179a(Sm149)Di\", \"CD72(Eu151)Di\", \"IgM(Eu153)Di\", \"Kappa(Sm154)Di\", \"CD10(Gd156)Di\", \"Lambda(Gd157)Di\", \"pSTAT3(Gd158)Di\", \"pBLNK(Gd160)Di\", \"CD38(Er168)Di\", \"pBTK(Yb171)Di\", \"HLA-DR(Yb174)Di\")\n\nes <- exprs(ff)\nwl <- es[, \"wanderlust\"]\nes <- es[, wl_chs]\nes_t <- asinh(es/5)\n\n# compute means & SD for ea. time point\ns <- .01\ninterval <- c(-.05, .05)\nmean <- sd <- matrix(0, nrow=1/s, ncol=ncol(es), dimnames=list(NULL, colnames(es)))\nfor (i in seq_len(1/s)) {\n    inds <- wl >= interval[1] & wl <= interval[2]\n    mean[i, ] <- colMeans(es[inds, ])\n    sd[i, ] <- apply(es[inds, ], 2, sd)\n    interval <- interval + s\n}\nsim <- matrix(0, nrow=1/s, ncol=ncol(es), dimnames=list(NULL, colnames(es)))\nfor (i in seq_len(1/s))\n    sim[i,] <- rnorm(ncol(es), mean[i,], sd[i,])\n\nmean <- asinh(mean/5)\nmean <- data.frame(t=seq_len(1/s), mean)\nmean <- melt(mean, id.var=\"t\")\nsim <- asinh(sim/5)\nsim <- data.frame(t=seq_len(1/s), sim)\nsim <- melt(sim, id.var=\"t\")\nggplot() + \n    geom_path(data=mean, aes(x=t, y=value)) +\n    geom_point(data=sim, aes(x=t, y=value), col=\"red\", size=.5) +\n    facet_wrap(~variable, scale=\"free_y\")\n\nlibrary(SCORPIUS)\ndists <- correlation_distance(sim)\nspace <- reduce_dimensionality(dists, ndim=2)\ntraj <- infer_trajectory(space)\n\ndists <- correlation_distance(es)\nspace <- reduce_dimensionality(dists, ndim=2)\ntraj <- infer_trajectory(space)\n\n\n\n\n\n\n\n\n\n",
    "created" : 1517665630568.000,
    "dirty" : true,
    "encoding" : "",
    "folds" : "",
    "hash" : "1666278655",
    "id" : "2A210728",
    "lastKnownWriteTime" : 0,
    "last_content_update" : 1517732280662,
    "path" : null,
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled3"
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}